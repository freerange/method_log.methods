    def commit(*source_files, user: { email: 'test@example.com', name: 'test', time: Time.now }, message: 'commit-message')
      build_commit.tap do |commit|
        source_files.each { |sf| commit.add(sf) }
        commit.apply(user: user, message: message)
        @commits << commit
      end
    end